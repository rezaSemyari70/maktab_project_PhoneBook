<!doctype html>
<html lang="en">

<head>
    <title>Phone Book</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="./main.css">
</head>

<body>
    <div id="root" class="container-fluid">
        <div id="main" class="">
            <div id="table" class="table-responsive">
                <table id="contact_table" class="table table-striped table-hover">
                    <thead class="thead-dark">
                        <tr>
                            <th>#</th>
                            <th>Name</th>
                            <th>Last Name</th>
                            <th>Phone</th>
                            <th>Email</th>
                            <th>Address</th>
                            <th>Birthday</th>
                            <th>Details</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <!-- <tbody>
                        <tr>
                            <td>1</td>
                            <td>reza</td>
                            <td>semyari</td>
                            <td>09102378108</td>
                            <td>reza@yahoo.com</td>
                            <td>azadi p5</td>
                            <td>1991/09/10</td>
                            <td>...</td>
                            <td>
                                <button onclick="delete_contact()" class="btn btn-danger"><i
                                        class="fa fa-trash"></i></button>
                                <button onclick="show_form()" class="btn btn-primary"><i
                                        class="fa fa-edit"></i></button>
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>ali</td>
                            <td>davari</td>
                            <td>09122348121</td>
                            <td>reza@yahoo.com</td>
                            <td>tahranpars p5</td>
                            <td>1986/02/03</td>
                            <td>...</td>
                            <td>
                                <button onclick="delete_contact()" class="btn btn-danger"><i
                                        class="fa fa-trash"></i></button>
                                <button onclick="show_form()" class="btn btn-primary"><i
                                        class="fa fa-edit"></i></button>
                            </td>
                        </tr>
                    </tbody> -->
                </table>
                <button onclick="show_form()" class="bg-dark text-white add-btn">Add</button>
            </div>
            <div id="form " class=" ">
                <form id="contact_form">
                    <div class="form-group">
                        <label for="id_name">ID:</label>
                        <input type="number" name="id" class="form-control" id="id_id" placeholder="id of contact">
                    </div>
                    <div class="form-group">
                        <label for="id_name">Name:</label>
                        <input type="text" name="name" class="form-control" id="id_name" placeholder="name">
                    </div>
                    <div class="form-group">
                        <label for="id">Lastname:</label>
                        <input type="text" name="lastname" class="form-control" id="id_lastname" placeholder="lastname">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputEmail1">Email address</label>
                        <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp"
                            placeholder="Enter email">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputPassword1">Password</label>
                        <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputEmail1">Email address</label>
                        <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp"
                            placeholder="Enter email">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputPassword1">Password</label>
                        <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
                    </div>
                    <div class="form-group">
                        <label for="exampleInputEmail1">Email address</label>
                        <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp"
                            placeholder="Enter email">
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>
            </div>
        </div>

    </div>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous">
    </script>

    <script>
        // let contactList = [{
        //         id: 1,
        //         name: 'reza',
        //         lastname: 'semyari',
        //         phone: '09102378108',
        //         email: 'reza@yahoo.com',
        //         address: 'azadi p5',
        //         Birthday: '1991/09/10',
        //         details: '...'
        //     },
        //     {
        //         id: 2,
        //         name: 'ali',
        //         lastname: 'naderi',
        //         phone: '09152343111',
        //         email: 'ali68@yahoo.com',
        //         address: 'tehranpars p5',
        //         birthday: '1989/03/23',
        //         details: '...'
        //     }
        // ];

        render_table();

        function remove_contact(id) {
            const contactList = JSON.parse(localStorage.getItem('contactList'));
            contactList = contactList.filter(item => item.if != id);
            localStorage.setItem('contactList', JSON.stringify(contactList));
            render_table();
        }

        function render_table() {
            const contactList = JSON.parse(localStorage.getItem('contactList'));
            if (!contactList) {
                localStorage.setItem('contactList', JSON.stringify([]))
                return;
            }
            const tbody2 = document.getElementsByTagName('tbody');
            if (tbody2.length > 0) {
                tbody2[0].remove();
            }

            const table = document.getElementById("contact_table");
            const tbody = document.createElement("TBODY");
            contactList.map(contact => {
                    const tr = document.createElement("TR");
                    tr.innerHTML =
                        `<td>${contact.id}</td><td>${contact.name}</td><td>${contact.lastname}</td><td>${contact.phone}</td><td>${contact.email}</td><td>${contact.address}</td><td>${contact.birthday}</td><td>${contact.details}</td><td><button onclick="delete_contact()" class="btn btn-danger"><i
                    class="fa fa-trash"></i></button></td> <td><button onclick="show_form()" class="btn btn-primary"><i class="fa fa-edit"></i></button></td>`
                    tbody.appendChild(tr);
                }

            )
            table.appendChild(tbody);
        }

        function show_form() {
            const el = document.getElementById('form');
            el.classList.add("show");
        }

        function hide_form() {
            const el = document.getElementById('form');
            el.classList.remove("show");
        }

        document.getElementById("contact_form").addEventListener("submit", function (event) {
            event.preventDefault();
            let contactList = JSON.parse(localStorage.getItem('contactList'));
            const new_contact_data = new FormData(document.querySelector('form'));
            let new_contact = {};
            for (let item of new_contact_data.entries()) {
                new_contact[item[0]] = item[1];
            }
            console.log(new_contact);
            contactList = [...contactList, new_contact];
            localStorage.setItem('contactList', JSON.stringify(contactList));
            hide_form();
            render_table();
        });

        function delete_contact(id) {
            Swal.fire({
                title: 'Are you sure?',
                text: "You won't be able to revert this!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, delete it!'
            }).then((result) => {
                if (result.value) {
                    remove_contact(id);
                    Swal.fire(
                        'Deleted!',
                        'Your file has been deleted.',
                        'success'
                    )
                }
            })
        }
    </script>
</body>

</html>